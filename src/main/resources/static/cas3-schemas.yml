components:
  schemas:
    Cas3NewApplication:
      type: object
      properties:
        crn:
          type: string
        convictionId:
          type: integer
          format: int64
          example: 1502724704
        deliusEventNumber:
          type: string
          example: "7"
        offenceId:
          type: string
          example: "M1502750438"
      required:
        - crn
    Cas3Application:
      type: object
      properties:
        id:
          type: string
          format: uuid
        person:
          $ref: '_shared.yml#/components/schemas/Person'
        createdAt:
          type: string
          format: date-time
        createdByUserId:
          type: string
          format: uuid
        schemaVersion:
          type: string
          format: uuid
        outdatedSchema:
          type: boolean
        data:
          $ref: '_shared.yml#/components/schemas/Unit'
        document:
          $ref: '_shared.yml#/components/schemas/Unit'
        status:
          $ref: '_shared.yml#/components/schemas/ApplicationStatus'
        risks:
          $ref: '_shared.yml#/components/schemas/PersonRisks'
        submittedAt:
          type: string
          format: date-time
        arrivalDate:
          type: string
          format: date-time
        offenceId:
          type: string
        assessmentId:
          type: string
          format: uuid
      required:
        - id
        - person
        - createdAt
        - createdByUserId
        - schemaVersion
        - outdatedSchema
        - status
        - offenceId
    Cas3ApplicationSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        person:
          $ref: '_shared.yml#/components/schemas/Person'
        createdAt:
          type: string
          format: date-time
        submittedAt:
          type: string
          format: date-time
        createdByUserId:
          type: string
          format: uuid
        status:
          $ref: '_shared.yml#/components/schemas/ApplicationStatus'
        risks:
          $ref: '_shared.yml#/components/schemas/PersonRisks'
      required:
        - id
        - person
        - createdAt
        - createdByUserId
        - status
    Cas3UpdateApplication:
      type: object
      properties:
        data:
          type: object
          additionalProperties:
            $ref: '_shared.yml#/components/schemas/Unit'
      required:
        - type
        - data
    Cas3SubmitApplication:
      type: object
      properties:
        arrivalDate:
          type: string
          format: date
        isRegisteredSexOffender:
          type: boolean
        needsAccessibleProperty:
          type: boolean
        hasHistoryOfArson:
          type: boolean
        isDutyToReferSubmitted:
          type: boolean
        dutyToReferSubmissionDate:
          type: string
          format: date
        dutyToReferOutcome:
          type: string
          example: 'Pending'
        isApplicationEligible:
          type: boolean
        eligibilityReason:
          type: string
        dutyToReferLocalAuthorityAreaName:
          type: string
        personReleaseDate:
          type: string
          format: date
          example: '2024-02-21'
        probationDeliveryUnitId:
          type: string
          format: uuid
        isHistoryOfSexualOffence:
          type: boolean
        isConcerningSexualBehaviour:
          type: boolean
        isConcerningArsonBehaviour:
          type: boolean
        prisonReleaseTypes:
          type: array
          items:
            type: string
            example: 'PSS'
        summaryData:
          $ref: '_shared.yml#/components/schemas/Unit'
        translatedDocument:
          $ref: '_shared.yml#/components/schemas/Unit'
      required:
        - probationDeliveryUnitId
        - arrivalDate
        - summaryData
    FutureBooking:
      type: object
      properties:
        id:
          type: string
          format: uuid
        person:
          $ref: '_shared.yml#/components/schemas/Person'
        arrivalDate:
          type: string
          format: date
        departureDate:
          type: string
          format: date
        bed:
          $ref: '_shared.yml#/components/schemas/Bed'
      required:
        - id
        - person
        - arrivalDate
        - departureDate
    Cas3BedspaceSearchParameters:
      type: object
      properties:
        startDate:
          type: string
          format: date
        durationDays:
          type: integer
          format: int64
          description: The number of days the Bed will need to be free from the start_date until
        probationDeliveryUnits:
          type: array
          description: The list of pdus Ids to search within
          items:
            type: string
            format: uuid
        premisesFilters:
          $ref: '#/components/schemas/PremisesFilters'
        bedspaceFilters:
          $ref: '#/components/schemas/BedspaceFilters'
      required:
        - probationDeliveryUnits
        - startDate
        - durationDays
    Cas3Bedspaces:
      type: object
      properties:
        bedspaces:
          type: array
          items:
            $ref: 'cas3-schemas.yml#/components/schemas/Cas3Bedspace'
        totalOnlineBedspaces:
          type: integer
          example: 5
        totalUpcomingBedspaces:
          type: integer
          example: 1
        totalArchivedBedspaces:
          type: integer
          example: 2
      required:
        - bedspaces
        - totalOnlineBedspaces
        - totalUpcomingBedspaces
        - totalArchivedBedspaces
    Cas3Bedspace:
      type: object
      properties:
        id:
          type: string
          format: uuid
        reference:
          type: string
        startDate:
          type: string
          format: date
          example: 2024-07-30
          description: Start date of the bedspace availability
        endDate:
          type: string
          format: date
          example: 2024-12-30
          description: End date of the bedspace availability
        status:
          $ref: '#/components/schemas/Cas3BedspaceStatus'
        notes:
          type: string
        characteristics:
          type: array
          items:
            $ref: '_shared.yml#/components/schemas/Characteristic'
        bedspaceCharacteristics:
          type: array
          items:
            $ref: '#/components/schemas/Cas3BedspaceCharacteristic'
      required:
        - id
        - reference
        - status
    Cas3Premises:
      type: object
      properties:
        id:
          type: string
          format: uuid
        reference:
          type: string
          example: Hope House
        addressLine1:
          type: string
          example: one something street
        addressLine2:
          type: string
          example: Blackmore End
        town:
          type: string
          example: Braintree
        postcode:
          type: string
          example: LS1 3AD
        localAuthorityArea:
          $ref: '_shared.yml#/components/schemas/LocalAuthorityArea'
        probationRegion:
          $ref: '_shared.yml#/components/schemas/ProbationRegion'
        probationDeliveryUnit:
          $ref: '_shared.yml#/components/schemas/ProbationDeliveryUnit'
        characteristics:
          type: array
          items:
            $ref: '_shared.yml#/components/schemas/Characteristic'
        startDate:
          type: string
          format: date
          example: 2024-03-30
          description: Start date of the property.
        status:
          $ref: 'cas3-schemas.yml#/components/schemas/Cas3PremisesStatus'
        notes:
          type: string
          example: some notes about this property
        turnaroundWorkingDays:
          type: integer
          example: 2
        totalOnlineBedspaces:
          type: integer
          example: 5
        totalUpcomingBedspaces:
          type: integer
          example: 1
        totalArchivedBedspaces:
          type: integer
          example: 2
      required:
        - id
        - reference
        - addressLine1
        - postcode
        - probationRegion
        - probationDeliveryUnit
        - status
        - totalOnlineBedspaces
        - totalUpcomingBedspaces
        - totalArchivedBedspaces
    Cas3NewPremises:
      type: object
      properties:
        reference:
          type: string
        addressLine1:
          type: string
        addressLine2:
          type: string
        town:
          type: string
        postcode:
          type: string
        localAuthorityAreaId:
          type: string
          format: uuid
        probationRegionId:
          type: string
          format: uuid
        probationDeliveryUnitId:
          type: string
          format: uuid
        characteristicIds:
          type: array
          items:
            type: string
            format: uuid
        notes:
          type: string
          example: some notes about this property
        turnaroundWorkingDays:
          type: integer
      required:
        - reference
        - addressLine1
        - postcode
        - probationRegionId
        - probationDeliveryUnitId
        - characteristicIds
    Cas3NewBedspace:
      type: object
      properties:
        reference:
          type: string
        startDate:
          type: string
          format: date
          example: 2024-03-30
          description: Start date of the bedspace availability.
        notes:
          type: string
        characteristicIds:
          type: array
          items:
            type: string
            format: uuid
      required:
        - reference
        - startDate
        - characteristicIds
    Cas3UpdateBedspace:
      type: object
      properties:
        reference:
          type: string
        notes:
          type: string
        characteristicIds:
          type: array
          items:
            type: string
            format: uuid
      required:
        - reference
        - characteristicIds
    PremisesFilters:
      type: object
      properties:
        includedCharacteristicIds:
          type: array
          items:
            type: string
            format: uuid
        excludedCharacteristicIds:
          type: array
          items:
            type: string
            format: uuid
    BedspaceFilters:
      type: object
      properties:
        includedCharacteristicIds:
          type: array
          items:
            type: string
            format: uuid
        excludedCharacteristicIds:
          type: array
          items:
            type: string
            format: uuid
    Cas3BedspaceSearchResults:
      type: object
      properties:
        resultsRoomCount:
          type: integer
          description: How many distinct Rooms the Beds in the results belong to
        resultsPremisesCount:
          type: integer
          description: How many distinct Premises the Beds in the results belong to
        resultsBedCount:
          type: integer
          description: How many Beds are in the results
        results:
          type: array
          items:
            $ref: '#/components/schemas/Cas3BedspaceSearchResult'
      required:
        - resultsRoomCount
        - resultsPremisesCount
        - resultsBedCount
        - results
    Cas3BedspaceSearchResult:
      type: object
      properties:
        premises:
          $ref: '_shared.yml#/components/schemas/BedSearchResultPremisesSummary'
        room:
          $ref: '_shared.yml#/components/schemas/BedSearchResultRoomSummary'
        bed:
          $ref: '_shared.yml#/components/schemas/BedSearchResultBedSummary'
        overlaps:
          type: array
          items:
            $ref: '#/components/schemas/Cas3BedspaceSearchResultOverlap'
      required:
        - premises
        - room
        - bed
        - overlaps
    Cas3BedspaceSearchResultOverlap:
      type: object
      properties:
        name:
          type: string
        crn:
          type: string
        sex:
          type: string
        personType:
          $ref: '_shared.yml#/components/schemas/PersonType'
        days:
          type: integer
        bookingId:
          type: string
          format: uuid
        roomId:
          type: string
          format: uuid
        assessmentId:
          type: string
          format: uuid
        isSexualRisk:
          type: boolean
      required:
        - name
        - crn
        - personType
        - days
        - bookingId
        - roomId
        - isSexualRisk
    Cas3PremisesSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          example: Hope House
        addressLine1:
          type: string
          example: one something street
        addressLine2:
          type: string
          example: Blackmore End
        postcode:
          type: string
          example: LS1 3AD
        pdu:
          type: string
        localAuthorityAreaName:
          type: string
        bedspaceCount:
          type: integer
          example: 22
        status:
          $ref: '_shared.yml#/components/schemas/PropertyStatus'
      required:
        - id
        - name
        - addressLine1
        - postcode
        - pdu
        - bedspaceCount
        - status
    Cas3PremisesSortBy:
      type: string
      enum:
        - pdu
        - la
    Cas3PremisesSearchResults:
      type: object
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/Cas3PremisesSearchResult'
        totalPremises:
          type: integer
          example: 50
        totalOnlineBedspaces:
          type: integer
          example: 15
        totalUpcomingBedspaces:
          type: integer
          example: 3
      required:
        - totalPremises
    Cas3PremisesSearchResult:
      type: object
      properties:
        id:
          type: string
          format: uuid
        reference:
          type: string
          example: Hope House
        addressLine1:
          type: string
          example: one something street
        addressLine2:
          type: string
          example: Blackmore End
        town:
          type: string
          example: Leeds
        postcode:
          type: string
          example: LS1 3AD
        pdu:
          type: string
        localAuthorityAreaName:
          type: string
        bedspaces:
          type: array
          items:
            $ref: '#/components/schemas/Cas3BedspacePremisesSearchResult'
        totalArchivedBedspaces:
          type: integer
          example: 4
      required:
        - id
        - reference
        - addressLine1
        - postcode
        - pdu
    Cas3BedspacePremisesSearchResult:
      type: object
      properties:
        id:
          type: string
          format: uuid
        reference:
          type: string
        status:
          $ref: '#/components/schemas/Cas3BedspaceStatus'
      required:
        - id
        - reference
        - status
    Cas3PremisesStatus:
      type: string
      enum:
        - online
        - archived
    Cas3BedspaceStatus:
      type: string
      enum:
        - online
        - archived
        - upcoming
    Cas3Departure:
      type: object
      properties:
        id:
          type: string
          format: uuid
        bookingId:
          type: string
          format: uuid
        dateTime:
          type: string
          format: date-time
        reason:
          $ref: '_shared.yml#/components/schemas/DepartureReason'
        notes:
          type: string
        moveOnCategory:
          $ref: '_shared.yml#/components/schemas/MoveOnCategory'
        createdAt:
          type: string
          format: date-time
      required:
        - id
        - bookingId
        - dateTime
        - reason
        - moveOnCategory
        - createdAt
    Cas3NewDeparture:
      type: object
      properties:
        dateTime:
          type: string
          format: date-time
        reasonId:
          type: string
          format: uuid
        notes:
          type: string
        moveOnCategoryId:
          type: string
          format: uuid
      required:
        - dateTime
        - reasonId
        - moveOnCategoryId
    Cas3ReportType:
      type: string
      enum:
        - referral
        - booking
        - bedUsage
        - bedOccupancy
        - futureBookings
        - futureBookingsCsv
        - bookingGap
    Cas3OASysGroup:
      type: object
      description: Groups questions and answers from OAsys
      properties:
        assessmentMetadata:
          $ref: '#/components/schemas/Cas3OASysAssessmentMetadata'
        answers:
          type: array
          items:
            $ref: '_shared.yml#/components/schemas/OASysQuestion'
      required:
        - assessmentMetadata
        - answers
    Cas3OASysAssessmentMetadata:
      type: object
      properties:
        hasApplicableAssessment:
          type: boolean
        dateStarted:
          type: string
          format: date-time
        dateCompleted:
          type: string
          format: date-time
      required:
        - hasApplicableAssessment
    Cas3Booking:
      allOf:
        - $ref: '#/components/schemas/Cas3BookingBody'
        - type: object
          properties:
            status:
              $ref: '#/components/schemas/Cas3BookingStatus'
            extensions:
              type: array
              items:
                $ref: '#/components/schemas/Cas3Extension'
            arrival:
              nullable: true
              allOf:
                - $ref: '#/components/schemas/Cas3Arrival'
            departure:
              description: The latest version of the departure, if it exists
              nullable: true
              allOf:
                - $ref: '#/components/schemas/Cas3Departure'
            departures:
              description: The full history of the departure
              type: array
              items:
                $ref: '#/components/schemas/Cas3Departure'
            nonArrival:
              nullable: true
              allOf:
                - $ref: '#/components/schemas/Cas3NonArrival'
            cancellation:
              description: The latest version of the cancellation, if it exists
              nullable: true
              allOf:
                - $ref: '#/components/schemas/Cas3Cancellation'
            cancellations:
              description: The full history of the cancellation
              type: array
              items:
                $ref: '#/components/schemas/Cas3Cancellation'
            confirmation:
              nullable: true
              allOf:
                - $ref: '#/components/schemas/Cas3Confirmation'
            turnaround:
              description: The latest version of the turnaround, if it exists
              nullable: true
              allOf:
                - $ref: '#/components/schemas/Cas3Turnaround'
            turnarounds:
              description: The full history of turnarounds
              type: array
              items:
                $ref: '#/components/schemas/Cas3Turnaround'
            turnaroundStartDate:
              type: string
              format: date
            effectiveEndDate:
              type: string
              format: date
            applicationId:
              type: string
              format: uuid
            assessmentId:
              type: string
              format: uuid
            premises:
              $ref: '#/components/schemas/Cas3BookingPremisesSummary'
          required:
            - status
            - extensions
            - departures
            - cancellations
            - premises
    Cas3BookingBody:
      type: object
      properties:
        id:
          type: string
          format: uuid
        person:
          $ref: '_shared.yml#/components/schemas/Person'
        arrivalDate:
          type: string
          format: date
        originalArrivalDate:
          type: string
          format: date
        departureDate:
          type: string
          format: date
        originalDepartureDate:
          type: string
          format: date
        createdAt:
          type: string
          format: date-time
        bedspace:
          $ref: '#/components/schemas/Cas3Bedspace'
      required:
        - id
        - person
        - arrivalDate
        - originalArrivalDate
        - departureDate
        - originalDepartureDate
        - createdAt
        - bedspace
    Cas3BookingStatus:
      type: string
      enum:
        - arrived
        - notMinusArrived
        - departed
        - cancelled
        - provisional
        - confirmed
        - closed
    Cas3Extension:
      type: object
      properties:
        id:
          type: string
          format: uuid
        bookingId:
          type: string
          format: uuid
        previousDepartureDate:
          type: string
          format: date
        newDepartureDate:
          type: string
          format: date
        notes:
          type: string
        createdAt:
          type: string
          format: date-time
      required:
        - id
        - bookingId
        - previousDepartureDate
        - newDepartureDate
        - createdAt
    Cas3Arrival:
      type: object
      properties:
        expectedDepartureDate:
          type: string
          format: date
        arrivalDate:
          type: string
          format: date
        arrivalTime:
          type: string
          format: time
        notes:
          type: string
        bookingId:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
      required:
        - type
        - bookingId
        - expectedDepartureDate
        - createdAt
        - arrivalDate
        - arrivalTime
    Cas3NonArrival:
      type: object
      properties:
        id:
          type: string
          format: uuid
        bookingId:
          type: string
          format: uuid
        date:
          type: string
          format: date
        reason:
          $ref: '_shared.yml#/components/schemas/NonArrivalReason'
        notes:
          type: string
        createdAt:
          type: string
          format: date-time
      required:
        - id
        - bookingId
        - date
        - reason
        - createdAt
    Cas3Cancellation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        bookingId:
          type: string
          format: uuid
        date:
          type: string
          format: date
        reason:
          $ref: '_shared.yml#/components/schemas/CancellationReason'
        notes:
          type: string
        createdAt:
          type: string
          format: date-time
        premisesName:
          type: string
        otherReason:
          type: string
      required:
        - bookingId
        - date
        - reason
        - createdAt
        - premisesName
    Cas3Confirmation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        bookingId:
          type: string
          format: uuid
        dateTime:
          type: string
          format: date-time
        notes:
          type: string
        createdAt:
          type: string
          format: date-time
      required:
        - id
        - bookingId
        - dateTime
        - createdAt
    Cas3Turnaround:
      type: object
      properties:
        id:
          type: string
          format: uuid
        bookingId:
          type: string
          format: uuid
        workingDays:
          type: integer
        createdAt:
          type: string
          format: date-time
      required:
        - id
        - bookingId
        - workingDays
        - createdAt
    Cas3BookingPremisesSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
      required:
        - id
        - name
    Cas3BedspaceCharacteristic:
      type: object
      properties:
        id:
          type: string
          format: uuid
          example: 952790c0-21d7-4fd6-a7e1-9018f08d8bb0
        description:
          type: string
          example: Is this premises catered (rather than self-catered)?
        name:
          type: string
          example: isCatered
      required:
        - id
        - description
